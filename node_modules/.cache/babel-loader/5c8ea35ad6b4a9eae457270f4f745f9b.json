{"ast":null,"code":"import { normolize } from \"../../utils/normolize\";\nimport { selectDishsIds } from \"../selectors\";\nimport { selectMenuByRestaurantId } from \"../../restaurant/selectors\";\nimport { dishSlice } from \"../index\";\nexport const loadDishesIfNotExist = restaurantId => (dispatch, getState) => {\n  const restaurantDishIds = selectMenuByRestaurantId(getState(), {\n    restaurantId\n  });\n  const loadedDishIds = selectDishsIds(getState()) || [];\n\n  if (restaurantDishIds !== null && restaurantDishIds !== void 0 && restaurantDishIds.every(restaurantDishId => loadedDishIds.includes(restaurantDishId))) {\n    return;\n  }\n\n  dispatch(dishSlice.actions.startLoading());\n  fetch(`http://localhost:3001/api/products?id=${restaurantId}`).then(response => response.json()).then(dishes => {\n    console.log(dishes);\n    dispatch(dishSlice.actions.successLoading(normolize(dishes)));\n  }).catch(() => {\n    console.log(\"error\");\n    dispatch(dishSlice.actions.failLoading());\n  });\n};","map":{"version":3,"names":["normolize","selectDishsIds","selectMenuByRestaurantId","dishSlice","loadDishesIfNotExist","restaurantId","dispatch","getState","restaurantDishIds","loadedDishIds","every","restaurantDishId","includes","actions","startLoading","fetch","then","response","json","dishes","console","log","successLoading","catch","failLoading"],"sources":["/Users/Arina.Karmanova/Documents/react-2022-09-22/src/store/dish/middlewares/loadDishesIfNotExist.js"],"sourcesContent":["import { normolize } from \"../../utils/normolize\";\nimport { selectDishsIds } from \"../selectors\";\nimport { selectMenuByRestaurantId } from \"../../restaurant/selectors\";\nimport { dishSlice } from \"../index\";\n\nexport const loadDishesIfNotExist = (restaurantId) => (dispatch, getState) => {\n  const restaurantDishIds = selectMenuByRestaurantId(getState(), {\n    restaurantId,\n  });\n  const loadedDishIds = selectDishsIds(getState()) || [];\n\n  if (\n    restaurantDishIds?.every((restaurantDishId) =>\n      loadedDishIds.includes(restaurantDishId)\n    )\n  ) {\n    return;\n  }\n\n  dispatch(dishSlice.actions.startLoading());\n\n  fetch(`http://localhost:3001/api/products?id=${restaurantId}`)\n    .then((response) => response.json())\n    .then((dishes) => {\n      console.log(dishes);\n      dispatch(dishSlice.actions.successLoading(normolize(dishes)));\n    })\n    .catch(() => {\n      console.log(\"error\");\n      dispatch(dishSlice.actions.failLoading());\n    });\n};\n"],"mappings":"AAAA,SAASA,SAAT,QAA0B,uBAA1B;AACA,SAASC,cAAT,QAA+B,cAA/B;AACA,SAASC,wBAAT,QAAyC,4BAAzC;AACA,SAASC,SAAT,QAA0B,UAA1B;AAEA,OAAO,MAAMC,oBAAoB,GAAIC,YAAD,IAAkB,CAACC,QAAD,EAAWC,QAAX,KAAwB;EAC5E,MAAMC,iBAAiB,GAAGN,wBAAwB,CAACK,QAAQ,EAAT,EAAa;IAC7DF;EAD6D,CAAb,CAAlD;EAGA,MAAMI,aAAa,GAAGR,cAAc,CAACM,QAAQ,EAAT,CAAd,IAA8B,EAApD;;EAEA,IACEC,iBADF,aACEA,iBADF,eACEA,iBAAiB,CAAEE,KAAnB,CAA0BC,gBAAD,IACvBF,aAAa,CAACG,QAAd,CAAuBD,gBAAvB,CADF,CADF,EAIE;IACA;EACD;;EAEDL,QAAQ,CAACH,SAAS,CAACU,OAAV,CAAkBC,YAAlB,EAAD,CAAR;EAEAC,KAAK,CAAE,yCAAwCV,YAAa,EAAvD,CAAL,CACGW,IADH,CACSC,QAAD,IAAcA,QAAQ,CAACC,IAAT,EADtB,EAEGF,IAFH,CAESG,MAAD,IAAY;IAChBC,OAAO,CAACC,GAAR,CAAYF,MAAZ;IACAb,QAAQ,CAACH,SAAS,CAACU,OAAV,CAAkBS,cAAlB,CAAiCtB,SAAS,CAACmB,MAAD,CAA1C,CAAD,CAAR;EACD,CALH,EAMGI,KANH,CAMS,MAAM;IACXH,OAAO,CAACC,GAAR,CAAY,OAAZ;IACAf,QAAQ,CAACH,SAAS,CAACU,OAAV,CAAkBW,WAAlB,EAAD,CAAR;EACD,CATH;AAUD,CA1BM"},"metadata":{},"sourceType":"module"}